angular.module("dietitian").controller("todayHistoryCtl",function($scope,$log,socket,state){function registerIoEvent(connection){connection.on("personalHistoryUpdated",function(dietList){$scope.$apply(function(){processDietList(dietList)})})}function processDietList(dietList){angular.forEach(dietList,function(diet,dietKey){$scope.ui.dietListByType[diet.diet_type].push(diet)})}$scope.state=state,$scope.ui={},$scope.ui.dietListByType={breakfast:[],lunch:[],dinner:[]},$scope.setCurrentTab=function(event,area,tab){event.preventDefault(),$scope.ui[area].currentTab=tab},$scope.$watch("state.todayDietList",function(newVal,oldVal){newVal!=oldVal&&processDietList(newVal)}),registerIoEvent(socket.connection)}).directive("todayDietReportByType",function($compile){return{restrict:"E",templateUrl:"todayDietReportByType",scope:{dietTypeLabel:"@",dietList:"="}}}).directive("todayDietReportByTypeMobile",function($compile){return{restrict:"E",templateUrl:"todayDietReportByTypeMobile",scope:{dietTypeLabel:"@",dietList:"="}}});